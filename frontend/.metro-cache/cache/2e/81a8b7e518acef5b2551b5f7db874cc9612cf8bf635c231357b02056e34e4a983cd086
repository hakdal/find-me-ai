{"dependencies":[{"name":"react-native-iap","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":12,"column":26,"index":232}}],"key":"ut9UHHakFA+G8TdPzEZoyICY5c8=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":13,"column":0,"index":233},"end":{"line":13,"column":26,"index":259}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"iapService\", {\n    enumerable: true,\n    get: function () {\n      return iapService;\n    }\n  });\n  Object.defineProperty(exports, \"PRODUCT_IDS\", {\n    enumerable: true,\n    get: function () {\n      return PRODUCT_IDS;\n    }\n  });\n  Object.defineProperty(exports, \"SUBSCRIPTION_IDS\", {\n    enumerable: true,\n    get: function () {\n      return SUBSCRIPTION_IDS;\n    }\n  });\n  var _reactNativeIap = require(_dependencyMap[0], \"react-native-iap\");\n  var _axios = require(_dependencyMap[1], \"axios\");\n  var axios = _interopDefault(_axios);\n  const BACKEND_URL = process.env.EXPO_PUBLIC_BACKEND_URL;\n\n  // Product IDs - must match Google Play Console\n  const PRODUCT_IDS = {\n    PERSONA_SINGLE: 'persona_single',\n    PERSONA_ALL: 'persona_all'\n  };\n  const SUBSCRIPTION_IDS = {\n    PERSONA_UNLIMITED: 'persona_unlimited'\n  };\n  class IAPService {\n    connected = false;\n    async initialize() {\n      try {\n        await (0, _reactNativeIap.initConnection)();\n        this.connected = true;\n        console.log('IAP Connection initialized');\n\n        // Setup listeners\n        this.purchaseUpdateSubscription = (0, _reactNativeIap.purchaseUpdatedListener)(async purchase => {\n          console.log('Purchase updated:', purchase);\n          await this.handlePurchase(purchase);\n        });\n        this.purchaseErrorSubscription = (0, _reactNativeIap.purchaseErrorListener)(error => {\n          console.warn('Purchase error:', error);\n        });\n        return true;\n      } catch (error) {\n        console.error('IAP initialization error:', error);\n        return false;\n      }\n    }\n    async getAvailableProducts() {\n      try {\n        const products = await (0, _reactNativeIap.getProducts)({\n          skus: [PRODUCT_IDS.PERSONA_SINGLE, PRODUCT_IDS.PERSONA_ALL]\n        });\n        console.log('Available products:', products);\n        return products;\n      } catch (error) {\n        console.error('Error getting products:', error);\n        return [];\n      }\n    }\n    async getAvailableSubscriptions() {\n      try {\n        const subscriptions = await (0, _reactNativeIap.getProducts)({\n          skus: [SUBSCRIPTION_IDS.PERSONA_UNLIMITED]\n        });\n        console.log('Available subscriptions:', subscriptions);\n        return subscriptions;\n      } catch (error) {\n        console.error('Error getting subscriptions:', error);\n        return [];\n      }\n    }\n    async purchaseProduct(productId) {\n      try {\n        await (0, _reactNativeIap.requestPurchase)({\n          sku: productId\n        });\n      } catch (error) {\n        console.error('Purchase request error:', error);\n        throw error;\n      }\n    }\n    async handlePurchase(purchase) {\n      try {\n        // Validate purchase with backend\n        const response = await axios.default.post(`${BACKEND_URL}/api/purchase/validate`, {\n          product_id: purchase.productId,\n          purchase_token: purchase.purchaseToken,\n          user_id: null // Add user ID if you have user system\n        });\n        if (response.data.valid) {\n          // Finish transaction\n          await (0, _reactNativeIap.finishTransaction)({\n            purchase,\n            isConsumable: false\n          });\n          console.log('Purchase validated and finished');\n          return true;\n        }\n        return false;\n      } catch (error) {\n        console.error('Error handling purchase:', error);\n        return false;\n      }\n    }\n    async disconnect() {\n      if (this.purchaseUpdateSubscription) {\n        this.purchaseUpdateSubscription.remove();\n      }\n      if (this.purchaseErrorSubscription) {\n        this.purchaseErrorSubscription.remove();\n      }\n      if (this.connected) {\n        await (0, _reactNativeIap.endConnection)();\n        this.connected = false;\n      }\n    }\n  }\n  const iapService = new IAPService();\n});","lineCount":136,"map":[[12,2,131,0,"Object"],[12,8,131,0],[12,9,131,0,"defineProperty"],[12,23,131,0],[12,24,131,0,"exports"],[12,31,131,0],[13,4,131,0,"enumerable"],[13,14,131,0],[14,4,131,0,"get"],[14,7,131,0],[14,18,131,0,"get"],[14,19,131,0],[15,6,131,0],[15,13,131,0,"iapService"],[15,23,131,0],[16,4,131,0],[17,2,131,0],[18,2,132,0,"Object"],[18,8,132,0],[18,9,132,0,"defineProperty"],[18,23,132,0],[18,24,132,0,"exports"],[18,31,132,0],[19,4,132,0,"enumerable"],[19,14,132,0],[20,4,132,0,"get"],[20,7,132,0],[20,18,132,0,"get"],[20,19,132,0],[21,6,132,0],[21,13,132,9,"PRODUCT_IDS"],[21,24,132,20],[22,4,132,20],[23,2,132,20],[24,2,132,0,"Object"],[24,8,132,0],[24,9,132,0,"defineProperty"],[24,23,132,0],[24,24,132,0,"exports"],[24,31,132,0],[25,4,132,0,"enumerable"],[25,14,132,0],[26,4,132,0,"get"],[26,7,132,0],[26,18,132,0,"get"],[26,19,132,0],[27,6,132,0],[27,13,132,22,"SUBSCRIPTION_IDS"],[27,29,132,38],[28,4,132,38],[29,2,132,38],[30,2,1,0],[30,6,1,0,"_reactNativeIap"],[30,21,1,0],[30,24,1,0,"require"],[30,31,1,0],[30,32,1,0,"_dependencyMap"],[30,46,1,0],[31,2,13,0],[31,6,13,0,"_axios"],[31,12,13,0],[31,15,13,0,"require"],[31,22,13,0],[31,23,13,0,"_dependencyMap"],[31,37,13,0],[32,2,13,0],[32,6,13,0,"axios"],[32,11,13,0],[32,14,13,0,"_interopDefault"],[32,29,13,0],[32,30,13,0,"_axios"],[32,36,13,0],[33,2,15,0],[33,8,15,6,"BACKEND_URL"],[33,19,15,17],[33,22,15,20,"process"],[33,29,15,27],[33,30,15,28,"env"],[33,33,15,31],[33,34,15,32,"EXPO_PUBLIC_BACKEND_URL"],[33,57,15,55],[35,2,17,0],[36,2,18,0],[36,8,18,6,"PRODUCT_IDS"],[36,19,18,17],[36,22,18,20],[37,4,19,2,"PERSONA_SINGLE"],[37,18,19,16],[37,20,19,18],[37,36,19,34],[38,4,20,2,"PERSONA_ALL"],[38,15,20,13],[38,17,20,15],[39,2,21,0],[39,3,21,1],[40,2,23,0],[40,8,23,6,"SUBSCRIPTION_IDS"],[40,24,23,22],[40,27,23,25],[41,4,24,2,"PERSONA_UNLIMITED"],[41,21,24,19],[41,23,24,21],[42,2,25,0],[42,3,25,1],[43,2,27,0],[43,8,27,6,"IAPService"],[43,18,27,16],[43,19,27,17],[44,4,30,10,"connected"],[44,13,30,19],[44,16,30,31],[44,21,30,36],[45,4,32,2],[45,10,32,8,"initialize"],[45,20,32,18,"initialize"],[45,21,32,18],[45,23,32,21],[46,6,33,4],[46,10,33,8],[47,8,34,6],[47,14,34,12],[47,18,34,12,"initConnection"],[47,33,34,26],[47,34,34,26,"initConnection"],[47,48,34,26],[47,50,34,27],[47,51,34,28],[48,8,35,6],[48,12,35,10],[48,13,35,11,"connected"],[48,22,35,20],[48,25,35,23],[48,29,35,27],[49,8,36,6,"console"],[49,15,36,13],[49,16,36,14,"log"],[49,19,36,17],[49,20,36,18],[49,48,36,46],[49,49,36,47],[51,8,38,6],[52,8,39,6],[52,12,39,10],[52,13,39,11,"purchaseUpdateSubscription"],[52,39,39,37],[52,42,39,40],[52,46,39,40,"purchaseUpdatedListener"],[52,61,39,63],[52,62,39,63,"purchaseUpdatedListener"],[52,85,39,63],[52,87,40,8],[52,93,40,15,"purchase"],[52,101,40,33],[52,105,40,38],[53,10,41,10,"console"],[53,17,41,17],[53,18,41,18,"log"],[53,21,41,21],[53,22,41,22],[53,41,41,41],[53,43,41,43,"purchase"],[53,51,41,51],[53,52,41,52],[54,10,42,10],[54,16,42,16],[54,20,42,20],[54,21,42,21,"handlePurchase"],[54,35,42,35],[54,36,42,36,"purchase"],[54,44,42,44],[54,45,42,45],[55,8,43,8],[55,9,44,6],[55,10,44,7],[56,8,46,6],[56,12,46,10],[56,13,46,11,"purchaseErrorSubscription"],[56,38,46,36],[56,41,46,39],[56,45,46,39,"purchaseErrorListener"],[56,60,46,60],[56,61,46,60,"purchaseErrorListener"],[56,82,46,60],[56,84,47,9,"error"],[56,89,47,29],[56,93,47,34],[57,10,48,10,"console"],[57,17,48,17],[57,18,48,18,"warn"],[57,22,48,22],[57,23,48,23],[57,40,48,40],[57,42,48,42,"error"],[57,47,48,47],[57,48,48,48],[58,8,49,8],[58,9,50,6],[58,10,50,7],[59,8,52,6],[59,15,52,13],[59,19,52,17],[60,6,53,4],[60,7,53,5],[60,8,53,6],[60,15,53,13,"error"],[60,20,53,18],[60,22,53,20],[61,8,54,6,"console"],[61,15,54,13],[61,16,54,14,"error"],[61,21,54,19],[61,22,54,20],[61,49,54,47],[61,51,54,49,"error"],[61,56,54,54],[61,57,54,55],[62,8,55,6],[62,15,55,13],[62,20,55,18],[63,6,56,4],[64,4,57,2],[65,4,59,2],[65,10,59,8,"getAvailableProducts"],[65,30,59,28,"getAvailableProducts"],[65,31,59,28],[65,33,59,31],[66,6,60,4],[66,10,60,8],[67,8,61,6],[67,14,61,12,"products"],[67,22,61,20],[67,25,61,23],[67,31,61,29],[67,35,61,29,"getProducts"],[67,50,61,40],[67,51,61,40,"getProducts"],[67,62,61,40],[67,64,61,41],[68,10,62,8,"skus"],[68,14,62,12],[68,16,62,14],[68,17,62,15,"PRODUCT_IDS"],[68,28,62,26],[68,29,62,27,"PERSONA_SINGLE"],[68,43,62,41],[68,45,62,43,"PRODUCT_IDS"],[68,56,62,54],[68,57,62,55,"PERSONA_ALL"],[68,68,62,66],[69,8,63,6],[69,9,63,7],[69,10,63,8],[70,8,64,6,"console"],[70,15,64,13],[70,16,64,14,"log"],[70,19,64,17],[70,20,64,18],[70,41,64,39],[70,43,64,41,"products"],[70,51,64,49],[70,52,64,50],[71,8,65,6],[71,15,65,13,"products"],[71,23,65,21],[72,6,66,4],[72,7,66,5],[72,8,66,6],[72,15,66,13,"error"],[72,20,66,18],[72,22,66,20],[73,8,67,6,"console"],[73,15,67,13],[73,16,67,14,"error"],[73,21,67,19],[73,22,67,20],[73,47,67,45],[73,49,67,47,"error"],[73,54,67,52],[73,55,67,53],[74,8,68,6],[74,15,68,13],[74,17,68,15],[75,6,69,4],[76,4,70,2],[77,4,72,2],[77,10,72,8,"getAvailableSubscriptions"],[77,35,72,33,"getAvailableSubscriptions"],[77,36,72,33],[77,38,72,36],[78,6,73,4],[78,10,73,8],[79,8,74,6],[79,14,74,12,"subscriptions"],[79,27,74,25],[79,30,74,28],[79,36,74,34],[79,40,74,34,"getProducts"],[79,55,74,45],[79,56,74,45,"getProducts"],[79,67,74,45],[79,69,74,46],[80,10,75,8,"skus"],[80,14,75,12],[80,16,75,14],[80,17,75,15,"SUBSCRIPTION_IDS"],[80,33,75,31],[80,34,75,32,"PERSONA_UNLIMITED"],[80,51,75,49],[81,8,76,6],[81,9,76,7],[81,10,76,8],[82,8,77,6,"console"],[82,15,77,13],[82,16,77,14,"log"],[82,19,77,17],[82,20,77,18],[82,46,77,44],[82,48,77,46,"subscriptions"],[82,61,77,59],[82,62,77,60],[83,8,78,6],[83,15,78,13,"subscriptions"],[83,28,78,26],[84,6,79,4],[84,7,79,5],[84,8,79,6],[84,15,79,13,"error"],[84,20,79,18],[84,22,79,20],[85,8,80,6,"console"],[85,15,80,13],[85,16,80,14,"error"],[85,21,80,19],[85,22,80,20],[85,52,80,50],[85,54,80,52,"error"],[85,59,80,57],[85,60,80,58],[86,8,81,6],[86,15,81,13],[86,17,81,15],[87,6,82,4],[88,4,83,2],[89,4,85,2],[89,10,85,8,"purchaseProduct"],[89,25,85,23,"purchaseProduct"],[89,26,85,24,"productId"],[89,35,85,41],[89,37,85,43],[90,6,86,4],[90,10,86,8],[91,8,87,6],[91,14,87,12],[91,18,87,12,"requestPurchase"],[91,33,87,27],[91,34,87,27,"requestPurchase"],[91,49,87,27],[91,51,87,28],[92,10,87,30,"sku"],[92,13,87,33],[92,15,87,35,"productId"],[93,8,87,45],[93,9,87,46],[93,10,87,47],[94,6,88,4],[94,7,88,5],[94,8,88,6],[94,15,88,13,"error"],[94,20,88,18],[94,22,88,20],[95,8,89,6,"console"],[95,15,89,13],[95,16,89,14,"error"],[95,21,89,19],[95,22,89,20],[95,47,89,45],[95,49,89,47,"error"],[95,54,89,52],[95,55,89,53],[96,8,90,6],[96,14,90,12,"error"],[96,19,90,17],[97,6,91,4],[98,4,92,2],[99,4,94,2],[99,10,94,8,"handlePurchase"],[99,24,94,22,"handlePurchase"],[99,25,94,23,"purchase"],[99,33,94,41],[99,35,94,43],[100,6,95,4],[100,10,95,8],[101,8,96,6],[102,8,97,6],[102,14,97,12,"response"],[102,22,97,20],[102,25,97,23],[102,31,97,29,"axios"],[102,36,97,34],[102,37,97,34,"default"],[102,44,97,34],[102,45,97,35,"post"],[102,49,97,39],[102,50,97,40],[102,53,97,43,"BACKEND_URL"],[102,64,97,54],[102,88,97,78],[102,90,97,80],[103,10,98,8,"product_id"],[103,20,98,18],[103,22,98,20,"purchase"],[103,30,98,28],[103,31,98,29,"productId"],[103,40,98,38],[104,10,99,8,"purchase_token"],[104,24,99,22],[104,26,99,24,"purchase"],[104,34,99,32],[104,35,99,33,"purchaseToken"],[104,48,99,46],[105,10,100,8,"user_id"],[105,17,100,15],[105,19,100,17],[105,23,100,21],[105,24,100,23],[106,8,101,6],[106,9,101,7],[106,10,101,8],[107,8,103,6],[107,12,103,10,"response"],[107,20,103,18],[107,21,103,19,"data"],[107,25,103,23],[107,26,103,24,"valid"],[107,31,103,29],[107,33,103,31],[108,10,104,8],[109,10,105,8],[109,16,105,14],[109,20,105,14,"finishTransaction"],[109,35,105,31],[109,36,105,31,"finishTransaction"],[109,53,105,31],[109,55,105,32],[110,12,105,34,"purchase"],[110,20,105,42],[111,12,105,44,"isConsumable"],[111,24,105,56],[111,26,105,58],[112,10,105,64],[112,11,105,65],[112,12,105,66],[113,10,106,8,"console"],[113,17,106,15],[113,18,106,16,"log"],[113,21,106,19],[113,22,106,20],[113,55,106,53],[113,56,106,54],[114,10,107,8],[114,17,107,15],[114,21,107,19],[115,8,108,6],[116,8,110,6],[116,15,110,13],[116,20,110,18],[117,6,111,4],[117,7,111,5],[117,8,111,6],[117,15,111,13,"error"],[117,20,111,18],[117,22,111,20],[118,8,112,6,"console"],[118,15,112,13],[118,16,112,14,"error"],[118,21,112,19],[118,22,112,20],[118,48,112,46],[118,50,112,48,"error"],[118,55,112,53],[118,56,112,54],[119,8,113,6],[119,15,113,13],[119,20,113,18],[120,6,114,4],[121,4,115,2],[122,4,117,2],[122,10,117,8,"disconnect"],[122,20,117,18,"disconnect"],[122,21,117,18],[122,23,117,21],[123,6,118,4],[123,10,118,8],[123,14,118,12],[123,15,118,13,"purchaseUpdateSubscription"],[123,41,118,39],[123,43,118,41],[124,8,119,6],[124,12,119,10],[124,13,119,11,"purchaseUpdateSubscription"],[124,39,119,37],[124,40,119,38,"remove"],[124,46,119,44],[124,47,119,45],[124,48,119,46],[125,6,120,4],[126,6,121,4],[126,10,121,8],[126,14,121,12],[126,15,121,13,"purchaseErrorSubscription"],[126,40,121,38],[126,42,121,40],[127,8,122,6],[127,12,122,10],[127,13,122,11,"purchaseErrorSubscription"],[127,38,122,36],[127,39,122,37,"remove"],[127,45,122,43],[127,46,122,44],[127,47,122,45],[128,6,123,4],[129,6,124,4],[129,10,124,8],[129,14,124,12],[129,15,124,13,"connected"],[129,24,124,22],[129,26,124,24],[130,8,125,6],[130,14,125,12],[130,18,125,12,"endConnection"],[130,33,125,25],[130,34,125,25,"endConnection"],[130,47,125,25],[130,49,125,26],[130,50,125,27],[131,8,126,6],[131,12,126,10],[131,13,126,11,"connected"],[131,22,126,20],[131,25,126,23],[131,30,126,28],[132,6,127,4],[133,4,128,2],[134,2,129,0],[135,2,131,7],[135,8,131,13,"iapService"],[135,18,131,23],[135,21,131,26],[135,25,131,30,"IAPService"],[135,35,131,40],[135,36,131,41],[135,37,131,42],[136,0,131,43],[136,3]],"functionMap":{"names":["<global>","IAPService","IAPService#initialize","purchaseUpdatedListener$argument_0","purchaseErrorListener$argument_0","IAPService#getAvailableProducts","IAPService#getAvailableSubscriptions","IAPService#purchaseProduct","IAPService#handlePurchase","IAPService#disconnect"],"mappings":"AAA;AC0B;ECK;QCQ;SDG;QEI;SFE;GDQ;EIE;GJW;EKE;GLW;EME;GNO;EOE;GPqB;EQE;GRW;CDC"},"hasCjsExports":false},"type":"js/module"}]}