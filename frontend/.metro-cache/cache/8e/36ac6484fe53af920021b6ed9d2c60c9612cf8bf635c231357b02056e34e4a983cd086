{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"react-native-iap","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":12,"column":26,"index":232}}],"key":"ut9UHHakFA+G8TdPzEZoyICY5c8=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":13,"column":0,"index":233},"end":{"line":13,"column":26,"index":259}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"iapService\", {\n    enumerable: true,\n    get: function () {\n      return iapService;\n    }\n  });\n  Object.defineProperty(exports, \"PRODUCT_IDS\", {\n    enumerable: true,\n    get: function () {\n      return PRODUCT_IDS;\n    }\n  });\n  Object.defineProperty(exports, \"SUBSCRIPTION_IDS\", {\n    enumerable: true,\n    get: function () {\n      return SUBSCRIPTION_IDS;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _reactNativeIap = require(_dependencyMap[1], \"react-native-iap\");\n  var _axios = require(_dependencyMap[2], \"axios\");\n  var axios = _interopDefault(_axios);\n  const BACKEND_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL;\n\n  // Product IDs - must match Google Play Console\n  const PRODUCT_IDS = {\n    PERSONA_SINGLE: 'persona_single',\n    PERSONA_ALL: 'persona_all'\n  };\n  const SUBSCRIPTION_IDS = {\n    PERSONA_UNLIMITED: 'persona_unlimited'\n  };\n  class IAPService {\n    connected = false;\n    async initialize() {\n      try {\n        await (0, _reactNativeIap.initConnection)();\n        this.connected = true;\n        console.log('IAP Connection initialized');\n\n        // Setup listeners\n        this.purchaseUpdateSubscription = (0, _reactNativeIap.purchaseUpdatedListener)(async purchase => {\n          console.log('Purchase updated:', purchase);\n          await this.handlePurchase(purchase);\n        });\n        this.purchaseErrorSubscription = (0, _reactNativeIap.purchaseErrorListener)(error => {\n          console.warn('Purchase error:', error);\n        });\n        return true;\n      } catch (error) {\n        console.error('IAP initialization error:', error);\n        return false;\n      }\n    }\n    async getAvailableProducts() {\n      try {\n        const products = await (0, _reactNativeIap.getProducts)({\n          skus: [PRODUCT_IDS.PERSONA_SINGLE, PRODUCT_IDS.PERSONA_ALL]\n        });\n        console.log('Available products:', products);\n        return products;\n      } catch (error) {\n        console.error('Error getting products:', error);\n        return [];\n      }\n    }\n    async getAvailableSubscriptions() {\n      try {\n        const subscriptions = await (0, _reactNativeIap.getProducts)({\n          skus: [SUBSCRIPTION_IDS.PERSONA_UNLIMITED]\n        });\n        console.log('Available subscriptions:', subscriptions);\n        return subscriptions;\n      } catch (error) {\n        console.error('Error getting subscriptions:', error);\n        return [];\n      }\n    }\n    async purchaseProduct(productId) {\n      try {\n        await (0, _reactNativeIap.requestPurchase)({\n          sku: productId\n        });\n      } catch (error) {\n        console.error('Purchase request error:', error);\n        throw error;\n      }\n    }\n    async handlePurchase(purchase) {\n      try {\n        // Validate purchase with backend\n        const response = await axios.default.post(`${BACKEND_URL}/api/purchase/validate`, {\n          product_id: purchase.productId,\n          purchase_token: purchase.purchaseToken,\n          user_id: null // Add user ID if you have user system\n        });\n        if (response.data.valid) {\n          // Finish transaction\n          await (0, _reactNativeIap.finishTransaction)({\n            purchase,\n            isConsumable: false\n          });\n          console.log('Purchase validated and finished');\n          return true;\n        }\n        return false;\n      } catch (error) {\n        console.error('Error handling purchase:', error);\n        return false;\n      }\n    }\n    async disconnect() {\n      if (this.purchaseUpdateSubscription) {\n        this.purchaseUpdateSubscription.remove();\n      }\n      if (this.purchaseErrorSubscription) {\n        this.purchaseErrorSubscription.remove();\n      }\n      if (this.connected) {\n        await (0, _reactNativeIap.endConnection)();\n        this.connected = false;\n      }\n    }\n  }\n  const iapService = new IAPService();\n});","lineCount":137,"map":[[12,2,131,0,"Object"],[12,8,131,0],[12,9,131,0,"defineProperty"],[12,23,131,0],[12,24,131,0,"exports"],[12,31,131,0],[13,4,131,0,"enumerable"],[13,14,131,0],[14,4,131,0,"get"],[14,7,131,0],[14,18,131,0,"get"],[14,19,131,0],[15,6,131,0],[15,13,131,0,"iapService"],[15,23,131,0],[16,4,131,0],[17,2,131,0],[18,2,132,0,"Object"],[18,8,132,0],[18,9,132,0,"defineProperty"],[18,23,132,0],[18,24,132,0,"exports"],[18,31,132,0],[19,4,132,0,"enumerable"],[19,14,132,0],[20,4,132,0,"get"],[20,7,132,0],[20,18,132,0,"get"],[20,19,132,0],[21,6,132,0],[21,13,132,9,"PRODUCT_IDS"],[21,24,132,20],[22,4,132,20],[23,2,132,20],[24,2,132,0,"Object"],[24,8,132,0],[24,9,132,0,"defineProperty"],[24,23,132,0],[24,24,132,0,"exports"],[24,31,132,0],[25,4,132,0,"enumerable"],[25,14,132,0],[26,4,132,0,"get"],[26,7,132,0],[26,18,132,0,"get"],[26,19,132,0],[27,6,132,0],[27,13,132,22,"SUBSCRIPTION_IDS"],[27,29,132,38],[28,4,132,38],[29,2,132,38],[30,2,132,41],[30,6,132,41,"_expoVirtualEnv"],[30,21,132,41],[30,24,132,41,"require"],[30,31,132,41],[30,32,132,41,"_dependencyMap"],[30,46,132,41],[31,2,1,0],[31,6,1,0,"_reactNativeIap"],[31,21,1,0],[31,24,1,0,"require"],[31,31,1,0],[31,32,1,0,"_dependencyMap"],[31,46,1,0],[32,2,13,0],[32,6,13,0,"_axios"],[32,12,13,0],[32,15,13,0,"require"],[32,22,13,0],[32,23,13,0,"_dependencyMap"],[32,37,13,0],[33,2,13,0],[33,6,13,0,"axios"],[33,11,13,0],[33,14,13,0,"_interopDefault"],[33,29,13,0],[33,30,13,0,"_axios"],[33,36,13,0],[34,2,15,0],[34,8,15,6,"BACKEND_URL"],[34,19,15,17],[34,22,15,17,"_expoVirtualEnv"],[34,37,15,17],[34,38,15,17,"env"],[34,41,15,17],[34,42,15,17,"EXPO_PUBLIC_BACKEND_URL"],[34,65,15,55],[36,2,17,0],[37,2,18,0],[37,8,18,6,"PRODUCT_IDS"],[37,19,18,17],[37,22,18,20],[38,4,19,2,"PERSONA_SINGLE"],[38,18,19,16],[38,20,19,18],[38,36,19,34],[39,4,20,2,"PERSONA_ALL"],[39,15,20,13],[39,17,20,15],[40,2,21,0],[40,3,21,1],[41,2,23,0],[41,8,23,6,"SUBSCRIPTION_IDS"],[41,24,23,22],[41,27,23,25],[42,4,24,2,"PERSONA_UNLIMITED"],[42,21,24,19],[42,23,24,21],[43,2,25,0],[43,3,25,1],[44,2,27,0],[44,8,27,6,"IAPService"],[44,18,27,16],[44,19,27,17],[45,4,30,10,"connected"],[45,13,30,19],[45,16,30,31],[45,21,30,36],[46,4,32,2],[46,10,32,8,"initialize"],[46,20,32,18,"initialize"],[46,21,32,18],[46,23,32,21],[47,6,33,4],[47,10,33,8],[48,8,34,6],[48,14,34,12],[48,18,34,12,"initConnection"],[48,33,34,26],[48,34,34,26,"initConnection"],[48,48,34,26],[48,50,34,27],[48,51,34,28],[49,8,35,6],[49,12,35,10],[49,13,35,11,"connected"],[49,22,35,20],[49,25,35,23],[49,29,35,27],[50,8,36,6,"console"],[50,15,36,13],[50,16,36,14,"log"],[50,19,36,17],[50,20,36,18],[50,48,36,46],[50,49,36,47],[52,8,38,6],[53,8,39,6],[53,12,39,10],[53,13,39,11,"purchaseUpdateSubscription"],[53,39,39,37],[53,42,39,40],[53,46,39,40,"purchaseUpdatedListener"],[53,61,39,63],[53,62,39,63,"purchaseUpdatedListener"],[53,85,39,63],[53,87,40,8],[53,93,40,15,"purchase"],[53,101,40,33],[53,105,40,38],[54,10,41,10,"console"],[54,17,41,17],[54,18,41,18,"log"],[54,21,41,21],[54,22,41,22],[54,41,41,41],[54,43,41,43,"purchase"],[54,51,41,51],[54,52,41,52],[55,10,42,10],[55,16,42,16],[55,20,42,20],[55,21,42,21,"handlePurchase"],[55,35,42,35],[55,36,42,36,"purchase"],[55,44,42,44],[55,45,42,45],[56,8,43,8],[56,9,44,6],[56,10,44,7],[57,8,46,6],[57,12,46,10],[57,13,46,11,"purchaseErrorSubscription"],[57,38,46,36],[57,41,46,39],[57,45,46,39,"purchaseErrorListener"],[57,60,46,60],[57,61,46,60,"purchaseErrorListener"],[57,82,46,60],[57,84,47,9,"error"],[57,89,47,29],[57,93,47,34],[58,10,48,10,"console"],[58,17,48,17],[58,18,48,18,"warn"],[58,22,48,22],[58,23,48,23],[58,40,48,40],[58,42,48,42,"error"],[58,47,48,47],[58,48,48,48],[59,8,49,8],[59,9,50,6],[59,10,50,7],[60,8,52,6],[60,15,52,13],[60,19,52,17],[61,6,53,4],[61,7,53,5],[61,8,53,6],[61,15,53,13,"error"],[61,20,53,18],[61,22,53,20],[62,8,54,6,"console"],[62,15,54,13],[62,16,54,14,"error"],[62,21,54,19],[62,22,54,20],[62,49,54,47],[62,51,54,49,"error"],[62,56,54,54],[62,57,54,55],[63,8,55,6],[63,15,55,13],[63,20,55,18],[64,6,56,4],[65,4,57,2],[66,4,59,2],[66,10,59,8,"getAvailableProducts"],[66,30,59,28,"getAvailableProducts"],[66,31,59,28],[66,33,59,31],[67,6,60,4],[67,10,60,8],[68,8,61,6],[68,14,61,12,"products"],[68,22,61,20],[68,25,61,23],[68,31,61,29],[68,35,61,29,"getProducts"],[68,50,61,40],[68,51,61,40,"getProducts"],[68,62,61,40],[68,64,61,41],[69,10,62,8,"skus"],[69,14,62,12],[69,16,62,14],[69,17,62,15,"PRODUCT_IDS"],[69,28,62,26],[69,29,62,27,"PERSONA_SINGLE"],[69,43,62,41],[69,45,62,43,"PRODUCT_IDS"],[69,56,62,54],[69,57,62,55,"PERSONA_ALL"],[69,68,62,66],[70,8,63,6],[70,9,63,7],[70,10,63,8],[71,8,64,6,"console"],[71,15,64,13],[71,16,64,14,"log"],[71,19,64,17],[71,20,64,18],[71,41,64,39],[71,43,64,41,"products"],[71,51,64,49],[71,52,64,50],[72,8,65,6],[72,15,65,13,"products"],[72,23,65,21],[73,6,66,4],[73,7,66,5],[73,8,66,6],[73,15,66,13,"error"],[73,20,66,18],[73,22,66,20],[74,8,67,6,"console"],[74,15,67,13],[74,16,67,14,"error"],[74,21,67,19],[74,22,67,20],[74,47,67,45],[74,49,67,47,"error"],[74,54,67,52],[74,55,67,53],[75,8,68,6],[75,15,68,13],[75,17,68,15],[76,6,69,4],[77,4,70,2],[78,4,72,2],[78,10,72,8,"getAvailableSubscriptions"],[78,35,72,33,"getAvailableSubscriptions"],[78,36,72,33],[78,38,72,36],[79,6,73,4],[79,10,73,8],[80,8,74,6],[80,14,74,12,"subscriptions"],[80,27,74,25],[80,30,74,28],[80,36,74,34],[80,40,74,34,"getProducts"],[80,55,74,45],[80,56,74,45,"getProducts"],[80,67,74,45],[80,69,74,46],[81,10,75,8,"skus"],[81,14,75,12],[81,16,75,14],[81,17,75,15,"SUBSCRIPTION_IDS"],[81,33,75,31],[81,34,75,32,"PERSONA_UNLIMITED"],[81,51,75,49],[82,8,76,6],[82,9,76,7],[82,10,76,8],[83,8,77,6,"console"],[83,15,77,13],[83,16,77,14,"log"],[83,19,77,17],[83,20,77,18],[83,46,77,44],[83,48,77,46,"subscriptions"],[83,61,77,59],[83,62,77,60],[84,8,78,6],[84,15,78,13,"subscriptions"],[84,28,78,26],[85,6,79,4],[85,7,79,5],[85,8,79,6],[85,15,79,13,"error"],[85,20,79,18],[85,22,79,20],[86,8,80,6,"console"],[86,15,80,13],[86,16,80,14,"error"],[86,21,80,19],[86,22,80,20],[86,52,80,50],[86,54,80,52,"error"],[86,59,80,57],[86,60,80,58],[87,8,81,6],[87,15,81,13],[87,17,81,15],[88,6,82,4],[89,4,83,2],[90,4,85,2],[90,10,85,8,"purchaseProduct"],[90,25,85,23,"purchaseProduct"],[90,26,85,24,"productId"],[90,35,85,41],[90,37,85,43],[91,6,86,4],[91,10,86,8],[92,8,87,6],[92,14,87,12],[92,18,87,12,"requestPurchase"],[92,33,87,27],[92,34,87,27,"requestPurchase"],[92,49,87,27],[92,51,87,28],[93,10,87,30,"sku"],[93,13,87,33],[93,15,87,35,"productId"],[94,8,87,45],[94,9,87,46],[94,10,87,47],[95,6,88,4],[95,7,88,5],[95,8,88,6],[95,15,88,13,"error"],[95,20,88,18],[95,22,88,20],[96,8,89,6,"console"],[96,15,89,13],[96,16,89,14,"error"],[96,21,89,19],[96,22,89,20],[96,47,89,45],[96,49,89,47,"error"],[96,54,89,52],[96,55,89,53],[97,8,90,6],[97,14,90,12,"error"],[97,19,90,17],[98,6,91,4],[99,4,92,2],[100,4,94,2],[100,10,94,8,"handlePurchase"],[100,24,94,22,"handlePurchase"],[100,25,94,23,"purchase"],[100,33,94,41],[100,35,94,43],[101,6,95,4],[101,10,95,8],[102,8,96,6],[103,8,97,6],[103,14,97,12,"response"],[103,22,97,20],[103,25,97,23],[103,31,97,29,"axios"],[103,36,97,34],[103,37,97,34,"default"],[103,44,97,34],[103,45,97,35,"post"],[103,49,97,39],[103,50,97,40],[103,53,97,43,"BACKEND_URL"],[103,64,97,54],[103,88,97,78],[103,90,97,80],[104,10,98,8,"product_id"],[104,20,98,18],[104,22,98,20,"purchase"],[104,30,98,28],[104,31,98,29,"productId"],[104,40,98,38],[105,10,99,8,"purchase_token"],[105,24,99,22],[105,26,99,24,"purchase"],[105,34,99,32],[105,35,99,33,"purchaseToken"],[105,48,99,46],[106,10,100,8,"user_id"],[106,17,100,15],[106,19,100,17],[106,23,100,21],[106,24,100,23],[107,8,101,6],[107,9,101,7],[107,10,101,8],[108,8,103,6],[108,12,103,10,"response"],[108,20,103,18],[108,21,103,19,"data"],[108,25,103,23],[108,26,103,24,"valid"],[108,31,103,29],[108,33,103,31],[109,10,104,8],[110,10,105,8],[110,16,105,14],[110,20,105,14,"finishTransaction"],[110,35,105,31],[110,36,105,31,"finishTransaction"],[110,53,105,31],[110,55,105,32],[111,12,105,34,"purchase"],[111,20,105,42],[112,12,105,44,"isConsumable"],[112,24,105,56],[112,26,105,58],[113,10,105,64],[113,11,105,65],[113,12,105,66],[114,10,106,8,"console"],[114,17,106,15],[114,18,106,16,"log"],[114,21,106,19],[114,22,106,20],[114,55,106,53],[114,56,106,54],[115,10,107,8],[115,17,107,15],[115,21,107,19],[116,8,108,6],[117,8,110,6],[117,15,110,13],[117,20,110,18],[118,6,111,4],[118,7,111,5],[118,8,111,6],[118,15,111,13,"error"],[118,20,111,18],[118,22,111,20],[119,8,112,6,"console"],[119,15,112,13],[119,16,112,14,"error"],[119,21,112,19],[119,22,112,20],[119,48,112,46],[119,50,112,48,"error"],[119,55,112,53],[119,56,112,54],[120,8,113,6],[120,15,113,13],[120,20,113,18],[121,6,114,4],[122,4,115,2],[123,4,117,2],[123,10,117,8,"disconnect"],[123,20,117,18,"disconnect"],[123,21,117,18],[123,23,117,21],[124,6,118,4],[124,10,118,8],[124,14,118,12],[124,15,118,13,"purchaseUpdateSubscription"],[124,41,118,39],[124,43,118,41],[125,8,119,6],[125,12,119,10],[125,13,119,11,"purchaseUpdateSubscription"],[125,39,119,37],[125,40,119,38,"remove"],[125,46,119,44],[125,47,119,45],[125,48,119,46],[126,6,120,4],[127,6,121,4],[127,10,121,8],[127,14,121,12],[127,15,121,13,"purchaseErrorSubscription"],[127,40,121,38],[127,42,121,40],[128,8,122,6],[128,12,122,10],[128,13,122,11,"purchaseErrorSubscription"],[128,38,122,36],[128,39,122,37,"remove"],[128,45,122,43],[128,46,122,44],[128,47,122,45],[129,6,123,4],[130,6,124,4],[130,10,124,8],[130,14,124,12],[130,15,124,13,"connected"],[130,24,124,22],[130,26,124,24],[131,8,125,6],[131,14,125,12],[131,18,125,12,"endConnection"],[131,33,125,25],[131,34,125,25,"endConnection"],[131,47,125,25],[131,49,125,26],[131,50,125,27],[132,8,126,6],[132,12,126,10],[132,13,126,11,"connected"],[132,22,126,20],[132,25,126,23],[132,30,126,28],[133,6,127,4],[134,4,128,2],[135,2,129,0],[136,2,131,7],[136,8,131,13,"iapService"],[136,18,131,23],[136,21,131,26],[136,25,131,30,"IAPService"],[136,35,131,40],[136,36,131,41],[136,37,131,42],[137,0,131,43],[137,3]],"functionMap":{"names":["<global>","IAPService","IAPService#initialize","purchaseUpdatedListener$argument_0","purchaseErrorListener$argument_0","IAPService#getAvailableProducts","IAPService#getAvailableSubscriptions","IAPService#purchaseProduct","IAPService#handlePurchase","IAPService#disconnect"],"mappings":"AAA;AC0B;ECK;QCQ;SDG;QEI;SFE;GDQ;EIE;GJW;EKE;GLW;EME;GNO;EOE;GPqB;EQE;GRW;CDC"},"hasCjsExports":false},"type":"js/module"}]}