{"dependencies":[{"name":"./scheduling.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":44,"index":44}}],"key":"oRBSLuVRjJSREN7NPSvV9kw44ME=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _schedulingJs = require(_dependencyMap[0], \"./scheduling.js\");\n  // http://www.w3.org/TR/2015/REC-IndexedDB-20150108/#dfn-database\n  class Database {\n    deletePending = false;\n    transactions = [];\n    rawObjectStores = new Map();\n    connections = [];\n    constructor(name, version) {\n      this.name = name;\n      this.version = version;\n      this.processTransactions = this.processTransactions.bind(this);\n    }\n    processTransactions() {\n      (0, _schedulingJs.queueTask)(() => {\n        const anyRunning = this.transactions.some(transaction => {\n          return transaction._started && transaction._state !== 'finished';\n        });\n        if (!anyRunning) {\n          const next = this.transactions.find(transaction => {\n            return !transaction._started && transaction._state !== 'finished';\n          });\n          if (next) {\n            next.addEventListener('complete', this.processTransactions);\n            next.addEventListener('abort', this.processTransactions);\n            next._start();\n          }\n        }\n      });\n    }\n  }\n  var _default = Database;\n});","lineCount":44,"map":[[7,2,32,0,"Object"],[7,8,32,0],[7,9,32,0,"defineProperty"],[7,23,32,0],[7,24,32,0,"exports"],[7,31,32,0],[8,4,32,0,"enumerable"],[8,14,32,0],[9,4,32,0,"get"],[9,7,32,0],[9,18,32,0,"get"],[9,19,32,0],[10,6,32,0],[10,13,32,0,"_default"],[10,21,32,0],[11,4,32,0],[12,2,32,0],[13,2,1,0],[13,6,1,0,"_schedulingJs"],[13,19,1,0],[13,22,1,0,"require"],[13,29,1,0],[13,30,1,0,"_dependencyMap"],[13,44,1,0],[14,2,3,0],[15,2,4,0],[15,8,4,6,"Database"],[15,16,4,14],[15,17,4,15],[16,4,5,2,"deletePending"],[16,17,5,15],[16,20,5,18],[16,25,5,23],[17,4,6,2,"transactions"],[17,16,6,14],[17,19,6,17],[17,21,6,19],[18,4,7,2,"rawObjectStores"],[18,19,7,17],[18,22,7,20],[18,26,7,24,"Map"],[18,29,7,27],[18,30,7,28],[18,31,7,29],[19,4,8,2,"connections"],[19,15,8,13],[19,18,8,16],[19,20,8,18],[20,4,9,2,"constructor"],[20,15,9,13,"constructor"],[20,16,9,14,"name"],[20,20,9,18],[20,22,9,20,"version"],[20,29,9,27],[20,31,9,29],[21,6,10,4],[21,10,10,8],[21,11,10,9,"name"],[21,15,10,13],[21,18,10,16,"name"],[21,22,10,20],[22,6,11,4],[22,10,11,8],[22,11,11,9,"version"],[22,18,11,16],[22,21,11,19,"version"],[22,28,11,26],[23,6,12,4],[23,10,12,8],[23,11,12,9,"processTransactions"],[23,30,12,28],[23,33,12,31],[23,37,12,35],[23,38,12,36,"processTransactions"],[23,57,12,55],[23,58,12,56,"bind"],[23,62,12,60],[23,63,12,61],[23,67,12,65],[23,68,12,66],[24,4,13,2],[25,4,14,2,"processTransactions"],[25,23,14,21,"processTransactions"],[25,24,14,21],[25,26,14,24],[26,6,15,4],[26,10,15,4,"queueTask"],[26,23,15,13],[26,24,15,13,"queueTask"],[26,33,15,13],[26,35,15,14],[26,41,15,20],[27,8,16,6],[27,14,16,12,"anyRunning"],[27,24,16,22],[27,27,16,25],[27,31,16,29],[27,32,16,30,"transactions"],[27,44,16,42],[27,45,16,43,"some"],[27,49,16,47],[27,50,16,48,"transaction"],[27,61,16,59],[27,65,16,63],[28,10,17,8],[28,17,17,15,"transaction"],[28,28,17,26],[28,29,17,27,"_started"],[28,37,17,35],[28,41,17,39,"transaction"],[28,52,17,50],[28,53,17,51,"_state"],[28,59,17,57],[28,64,17,62],[28,74,17,72],[29,8,18,6],[29,9,18,7],[29,10,18,8],[30,8,19,6],[30,12,19,10],[30,13,19,11,"anyRunning"],[30,23,19,21],[30,25,19,23],[31,10,20,8],[31,16,20,14,"next"],[31,20,20,18],[31,23,20,21],[31,27,20,25],[31,28,20,26,"transactions"],[31,40,20,38],[31,41,20,39,"find"],[31,45,20,43],[31,46,20,44,"transaction"],[31,57,20,55],[31,61,20,59],[32,12,21,10],[32,19,21,17],[32,20,21,18,"transaction"],[32,31,21,29],[32,32,21,30,"_started"],[32,40,21,38],[32,44,21,42,"transaction"],[32,55,21,53],[32,56,21,54,"_state"],[32,62,21,60],[32,67,21,65],[32,77,21,75],[33,10,22,8],[33,11,22,9],[33,12,22,10],[34,10,23,8],[34,14,23,12,"next"],[34,18,23,16],[34,20,23,18],[35,12,24,10,"next"],[35,16,24,14],[35,17,24,15,"addEventListener"],[35,33,24,31],[35,34,24,32],[35,44,24,42],[35,46,24,44],[35,50,24,48],[35,51,24,49,"processTransactions"],[35,70,24,68],[35,71,24,69],[36,12,25,10,"next"],[36,16,25,14],[36,17,25,15,"addEventListener"],[36,33,25,31],[36,34,25,32],[36,41,25,39],[36,43,25,41],[36,47,25,45],[36,48,25,46,"processTransactions"],[36,67,25,65],[36,68,25,66],[37,12,26,10,"next"],[37,16,26,14],[37,17,26,15,"_start"],[37,23,26,21],[37,24,26,22],[37,25,26,23],[38,10,27,8],[39,8,28,6],[40,6,29,4],[40,7,29,5],[40,8,29,6],[41,4,30,2],[42,2,31,0],[43,2,32,0],[43,6,32,0,"_default"],[43,14,32,0],[43,17,32,15,"Database"],[43,25,32,23],[44,0,32,24],[44,3]],"functionMap":{"names":["<global>","Database","constructor","processTransactions","queueTask$argument_0","transactions.some$argument_0","transactions.find$argument_0"],"mappings":"AAA;ACG;ECK;GDI;EEC;cCC;gDCC;ODE;4CEE;SFE;KDO;GFC;CDC"},"hasCjsExports":false},"type":"js/module"}]}