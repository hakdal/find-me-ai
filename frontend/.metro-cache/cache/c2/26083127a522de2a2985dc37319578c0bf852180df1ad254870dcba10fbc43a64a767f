{"dependencies":[{"name":"./errors.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":48,"index":48}}],"key":"sBFAilsnlkNTfGhyvhhjLjsyBXM=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _errorsJs = require(_dependencyMap[0], \"./errors.js\");\n  const stopped = (event, listener) => {\n    return event.immediatePropagationStopped || event.eventPhase === event.CAPTURING_PHASE && listener.capture === false || event.eventPhase === event.BUBBLING_PHASE && listener.capture === true;\n  };\n\n  // http://www.w3.org/TR/dom/#concept-event-listener-invoke\n  const invokeEventListeners = (event, obj) => {\n    event.currentTarget = obj;\n\n    // The callback might cause obj.listeners to mutate as we traverse it.\n    // Take a copy of the array so that nothing sneaks in and we don't lose\n    // our place.\n    for (const listener of obj.listeners.slice()) {\n      if (event.type !== listener.type || stopped(event, listener)) {\n        continue;\n      }\n\n      // @ts-ignore\n      listener.callback.call(event.currentTarget, event);\n    }\n    const typeToProp = {\n      abort: 'onabort',\n      blocked: 'onblocked',\n      complete: 'oncomplete',\n      error: 'onerror',\n      success: 'onsuccess',\n      upgradeneeded: 'onupgradeneeded',\n      versionchange: 'onversionchange'\n    };\n    const prop = typeToProp[event.type];\n    if (prop === undefined) {\n      throw new Error(`Unknown event type: \"${event.type}\"`);\n    }\n    const callback = event.currentTarget[prop];\n    if (callback) {\n      const listener = {\n        callback,\n        capture: false,\n        type: event.type\n      };\n      if (!stopped(event, listener)) {\n        // @ts-ignore\n        listener.callback.call(event.currentTarget, event);\n      }\n    }\n  };\n  class FakeEventTarget {\n    listeners = [];\n\n    // These will be overridden in individual subclasses and made not readonly\n\n    addEventListener(type, callback, capture = false) {\n      this.listeners.push({\n        callback,\n        capture,\n        type\n      });\n    }\n    removeEventListener(type, callback, capture = false) {\n      const i = this.listeners.findIndex(listener => {\n        return listener.type === type && listener.callback === callback && listener.capture === capture;\n      });\n      this.listeners.splice(i, 1);\n    }\n\n    // http://www.w3.org/TR/dom/#dispatching-events\n    dispatchEvent(event) {\n      if (event.dispatched || !event.initialized) {\n        throw new _errorsJs.InvalidStateError('The object is in an invalid state.');\n      }\n      event.isTrusted = false;\n      event.dispatched = true;\n      event.target = this;\n      // NOT SURE WHEN THIS SHOULD BE SET        event.eventPath = [];\n\n      event.eventPhase = event.CAPTURING_PHASE;\n      for (const obj of event.eventPath) {\n        if (!event.propagationStopped) {\n          invokeEventListeners(event, obj);\n        }\n      }\n      event.eventPhase = event.AT_TARGET;\n      if (!event.propagationStopped) {\n        invokeEventListeners(event, event.target);\n      }\n      if (event.bubbles) {\n        event.eventPath.reverse();\n        event.eventPhase = event.BUBBLING_PHASE;\n        for (const obj of event.eventPath) {\n          if (!event.propagationStopped) {\n            invokeEventListeners(event, obj);\n          }\n        }\n      }\n      event.dispatched = false;\n      event.eventPhase = event.NONE;\n      event.currentTarget = null;\n      if (event.canceled) {\n        return false;\n      }\n      return true;\n    }\n  }\n  var _default = FakeEventTarget;\n});","lineCount":117,"map":[[7,2,110,0,"Object"],[7,8,110,0],[7,9,110,0,"defineProperty"],[7,23,110,0],[7,24,110,0,"exports"],[7,31,110,0],[8,4,110,0,"enumerable"],[8,14,110,0],[9,4,110,0,"get"],[9,7,110,0],[9,18,110,0,"get"],[9,19,110,0],[10,6,110,0],[10,13,110,0,"_default"],[10,21,110,0],[11,4,110,0],[12,2,110,0],[13,2,1,0],[13,6,1,0,"_errorsJs"],[13,15,1,0],[13,18,1,0,"require"],[13,25,1,0],[13,26,1,0,"_dependencyMap"],[13,40,1,0],[14,2,2,0],[14,8,2,6,"stopped"],[14,15,2,13],[14,18,2,16,"stopped"],[14,19,2,17,"event"],[14,24,2,22],[14,26,2,24,"listener"],[14,34,2,32],[14,39,2,37],[15,4,3,2],[15,11,4,4,"event"],[15,16,4,9],[15,17,4,10,"immediatePropagationStopped"],[15,44,4,37],[15,48,5,5,"event"],[15,53,5,10],[15,54,5,11,"eventPhase"],[15,64,5,21],[15,69,5,26,"event"],[15,74,5,31],[15,75,5,32,"CAPTURING_PHASE"],[15,90,5,47],[15,94,5,51,"listener"],[15,102,5,59],[15,103,5,60,"capture"],[15,110,5,67],[15,115,5,72],[15,120,5,78],[15,124,6,5,"event"],[15,129,6,10],[15,130,6,11,"eventPhase"],[15,140,6,21],[15,145,6,26,"event"],[15,150,6,31],[15,151,6,32,"BUBBLING_PHASE"],[15,165,6,46],[15,169,6,50,"listener"],[15,177,6,58],[15,178,6,59,"capture"],[15,185,6,66],[15,190,6,71],[15,194,6,76],[16,2,8,0],[16,3,8,1],[18,2,10,0],[19,2,11,0],[19,8,11,6,"invokeEventListeners"],[19,28,11,26],[19,31,11,29,"invokeEventListeners"],[19,32,11,30,"event"],[19,37,11,35],[19,39,11,37,"obj"],[19,42,11,40],[19,47,11,45],[20,4,12,2,"event"],[20,9,12,7],[20,10,12,8,"currentTarget"],[20,23,12,21],[20,26,12,24,"obj"],[20,29,12,27],[22,4,14,2],[23,4,15,2],[24,4,16,2],[25,4,17,2],[25,9,17,7],[25,15,17,13,"listener"],[25,23,17,21],[25,27,17,25,"obj"],[25,30,17,28],[25,31,17,29,"listeners"],[25,40,17,38],[25,41,17,39,"slice"],[25,46,17,44],[25,47,17,45],[25,48,17,46],[25,50,17,48],[26,6,18,4],[26,10,18,8,"event"],[26,15,18,13],[26,16,18,14,"type"],[26,20,18,18],[26,25,18,23,"listener"],[26,33,18,31],[26,34,18,32,"type"],[26,38,18,36],[26,42,18,40,"stopped"],[26,49,18,47],[26,50,18,48,"event"],[26,55,18,53],[26,57,18,55,"listener"],[26,65,18,63],[26,66,18,64],[26,68,18,66],[27,8,19,6],[28,6,20,4],[30,6,22,4],[31,6,23,4,"listener"],[31,14,23,12],[31,15,23,13,"callback"],[31,23,23,21],[31,24,23,22,"call"],[31,28,23,26],[31,29,23,27,"event"],[31,34,23,32],[31,35,23,33,"currentTarget"],[31,48,23,46],[31,50,23,48,"event"],[31,55,23,53],[31,56,23,54],[32,4,24,2],[33,4,25,2],[33,10,25,8,"typeToProp"],[33,20,25,18],[33,23,25,21],[34,6,26,4,"abort"],[34,11,26,9],[34,13,26,11],[34,22,26,20],[35,6,27,4,"blocked"],[35,13,27,11],[35,15,27,13],[35,26,27,24],[36,6,28,4,"complete"],[36,14,28,12],[36,16,28,14],[36,28,28,26],[37,6,29,4,"error"],[37,11,29,9],[37,13,29,11],[37,22,29,20],[38,6,30,4,"success"],[38,13,30,11],[38,15,30,13],[38,26,30,24],[39,6,31,4,"upgradeneeded"],[39,19,31,17],[39,21,31,19],[39,38,31,36],[40,6,32,4,"versionchange"],[40,19,32,17],[40,21,32,19],[41,4,33,2],[41,5,33,3],[42,4,34,2],[42,10,34,8,"prop"],[42,14,34,12],[42,17,34,15,"typeToProp"],[42,27,34,25],[42,28,34,26,"event"],[42,33,34,31],[42,34,34,32,"type"],[42,38,34,36],[42,39,34,37],[43,4,35,2],[43,8,35,6,"prop"],[43,12,35,10],[43,17,35,15,"undefined"],[43,26,35,24],[43,28,35,26],[44,6,36,4],[44,12,36,10],[44,16,36,14,"Error"],[44,21,36,19],[44,22,36,20],[44,46,36,44,"event"],[44,51,36,49],[44,52,36,50,"type"],[44,56,36,54],[44,59,36,57],[44,60,36,58],[45,4,37,2],[46,4,38,2],[46,10,38,8,"callback"],[46,18,38,16],[46,21,38,19,"event"],[46,26,38,24],[46,27,38,25,"currentTarget"],[46,40,38,38],[46,41,38,39,"prop"],[46,45,38,43],[46,46,38,44],[47,4,39,2],[47,8,39,6,"callback"],[47,16,39,14],[47,18,39,16],[48,6,40,4],[48,12,40,10,"listener"],[48,20,40,18],[48,23,40,21],[49,8,41,6,"callback"],[49,16,41,14],[50,8,42,6,"capture"],[50,15,42,13],[50,17,42,15],[50,22,42,20],[51,8,43,6,"type"],[51,12,43,10],[51,14,43,12,"event"],[51,19,43,17],[51,20,43,18,"type"],[52,6,44,4],[52,7,44,5],[53,6,45,4],[53,10,45,8],[53,11,45,9,"stopped"],[53,18,45,16],[53,19,45,17,"event"],[53,24,45,22],[53,26,45,24,"listener"],[53,34,45,32],[53,35,45,33],[53,37,45,35],[54,8,46,6],[55,8,47,6,"listener"],[55,16,47,14],[55,17,47,15,"callback"],[55,25,47,23],[55,26,47,24,"call"],[55,30,47,28],[55,31,47,29,"event"],[55,36,47,34],[55,37,47,35,"currentTarget"],[55,50,47,48],[55,52,47,50,"event"],[55,57,47,55],[55,58,47,56],[56,6,48,4],[57,4,49,2],[58,2,50,0],[58,3,50,1],[59,2,51,0],[59,8,51,6,"FakeEventTarget"],[59,23,51,21],[59,24,51,22],[60,4,52,2,"listeners"],[60,13,52,11],[60,16,52,14],[60,18,52,16],[62,4,54,2],[64,4,56,2,"addEventListener"],[64,20,56,18,"addEventListener"],[64,21,56,19,"type"],[64,25,56,23],[64,27,56,25,"callback"],[64,35,56,33],[64,37,56,35,"capture"],[64,44,56,42],[64,47,56,45],[64,52,56,50],[64,54,56,52],[65,6,57,4],[65,10,57,8],[65,11,57,9,"listeners"],[65,20,57,18],[65,21,57,19,"push"],[65,25,57,23],[65,26,57,24],[66,8,58,6,"callback"],[66,16,58,14],[67,8,59,6,"capture"],[67,15,59,13],[68,8,60,6,"type"],[69,6,61,4],[69,7,61,5],[69,8,61,6],[70,4,62,2],[71,4,63,2,"removeEventListener"],[71,23,63,21,"removeEventListener"],[71,24,63,22,"type"],[71,28,63,26],[71,30,63,28,"callback"],[71,38,63,36],[71,40,63,38,"capture"],[71,47,63,45],[71,50,63,48],[71,55,63,53],[71,57,63,55],[72,6,64,4],[72,12,64,10,"i"],[72,13,64,11],[72,16,64,14],[72,20,64,18],[72,21,64,19,"listeners"],[72,30,64,28],[72,31,64,29,"findIndex"],[72,40,64,38],[72,41,64,39,"listener"],[72,49,64,47],[72,53,64,51],[73,8,65,6],[73,15,66,8,"listener"],[73,23,66,16],[73,24,66,17,"type"],[73,28,66,21],[73,33,66,26,"type"],[73,37,66,30],[73,41,66,34,"listener"],[73,49,66,42],[73,50,66,43,"callback"],[73,58,66,51],[73,63,66,56,"callback"],[73,71,66,64],[73,75,66,68,"listener"],[73,83,66,76],[73,84,66,77,"capture"],[73,91,66,84],[73,96,66,89,"capture"],[73,103,66,96],[74,6,68,4],[74,7,68,5],[74,8,68,6],[75,6,69,4],[75,10,69,8],[75,11,69,9,"listeners"],[75,20,69,18],[75,21,69,19,"splice"],[75,27,69,25],[75,28,69,26,"i"],[75,29,69,27],[75,31,69,29],[75,32,69,30],[75,33,69,31],[76,4,70,2],[78,4,72,2],[79,4,73,2,"dispatchEvent"],[79,17,73,15,"dispatchEvent"],[79,18,73,16,"event"],[79,23,73,21],[79,25,73,23],[80,6,74,4],[80,10,74,8,"event"],[80,15,74,13],[80,16,74,14,"dispatched"],[80,26,74,24],[80,30,74,28],[80,31,74,29,"event"],[80,36,74,34],[80,37,74,35,"initialized"],[80,48,74,46],[80,50,74,48],[81,8,75,6],[81,14,75,12],[81,18,75,16,"InvalidStateError"],[81,27,75,33],[81,28,75,33,"InvalidStateError"],[81,45,75,33],[81,46,75,34],[81,82,75,70],[81,83,75,71],[82,6,76,4],[83,6,77,4,"event"],[83,11,77,9],[83,12,77,10,"isTrusted"],[83,21,77,19],[83,24,77,22],[83,29,77,27],[84,6,78,4,"event"],[84,11,78,9],[84,12,78,10,"dispatched"],[84,22,78,20],[84,25,78,23],[84,29,78,27],[85,6,79,4,"event"],[85,11,79,9],[85,12,79,10,"target"],[85,18,79,16],[85,21,79,19],[85,25,79,23],[86,6,80,4],[88,6,82,4,"event"],[88,11,82,9],[88,12,82,10,"eventPhase"],[88,22,82,20],[88,25,82,23,"event"],[88,30,82,28],[88,31,82,29,"CAPTURING_PHASE"],[88,46,82,44],[89,6,83,4],[89,11,83,9],[89,17,83,15,"obj"],[89,20,83,18],[89,24,83,22,"event"],[89,29,83,27],[89,30,83,28,"eventPath"],[89,39,83,37],[89,41,83,39],[90,8,84,6],[90,12,84,10],[90,13,84,11,"event"],[90,18,84,16],[90,19,84,17,"propagationStopped"],[90,37,84,35],[90,39,84,37],[91,10,85,8,"invokeEventListeners"],[91,30,85,28],[91,31,85,29,"event"],[91,36,85,34],[91,38,85,36,"obj"],[91,41,85,39],[91,42,85,40],[92,8,86,6],[93,6,87,4],[94,6,88,4,"event"],[94,11,88,9],[94,12,88,10,"eventPhase"],[94,22,88,20],[94,25,88,23,"event"],[94,30,88,28],[94,31,88,29,"AT_TARGET"],[94,40,88,38],[95,6,89,4],[95,10,89,8],[95,11,89,9,"event"],[95,16,89,14],[95,17,89,15,"propagationStopped"],[95,35,89,33],[95,37,89,35],[96,8,90,6,"invokeEventListeners"],[96,28,90,26],[96,29,90,27,"event"],[96,34,90,32],[96,36,90,34,"event"],[96,41,90,39],[96,42,90,40,"target"],[96,48,90,46],[96,49,90,47],[97,6,91,4],[98,6,92,4],[98,10,92,8,"event"],[98,15,92,13],[98,16,92,14,"bubbles"],[98,23,92,21],[98,25,92,23],[99,8,93,6,"event"],[99,13,93,11],[99,14,93,12,"eventPath"],[99,23,93,21],[99,24,93,22,"reverse"],[99,31,93,29],[99,32,93,30],[99,33,93,31],[100,8,94,6,"event"],[100,13,94,11],[100,14,94,12,"eventPhase"],[100,24,94,22],[100,27,94,25,"event"],[100,32,94,30],[100,33,94,31,"BUBBLING_PHASE"],[100,47,94,45],[101,8,95,6],[101,13,95,11],[101,19,95,17,"obj"],[101,22,95,20],[101,26,95,24,"event"],[101,31,95,29],[101,32,95,30,"eventPath"],[101,41,95,39],[101,43,95,41],[102,10,96,8],[102,14,96,12],[102,15,96,13,"event"],[102,20,96,18],[102,21,96,19,"propagationStopped"],[102,39,96,37],[102,41,96,39],[103,12,97,10,"invokeEventListeners"],[103,32,97,30],[103,33,97,31,"event"],[103,38,97,36],[103,40,97,38,"obj"],[103,43,97,41],[103,44,97,42],[104,10,98,8],[105,8,99,6],[106,6,100,4],[107,6,101,4,"event"],[107,11,101,9],[107,12,101,10,"dispatched"],[107,22,101,20],[107,25,101,23],[107,30,101,28],[108,6,102,4,"event"],[108,11,102,9],[108,12,102,10,"eventPhase"],[108,22,102,20],[108,25,102,23,"event"],[108,30,102,28],[108,31,102,29,"NONE"],[108,35,102,33],[109,6,103,4,"event"],[109,11,103,9],[109,12,103,10,"currentTarget"],[109,25,103,23],[109,28,103,26],[109,32,103,30],[110,6,104,4],[110,10,104,8,"event"],[110,15,104,13],[110,16,104,14,"canceled"],[110,24,104,22],[110,26,104,24],[111,8,105,6],[111,15,105,13],[111,20,105,18],[112,6,106,4],[113,6,107,4],[113,13,107,11],[113,17,107,15],[114,4,108,2],[115,2,109,0],[116,2,110,0],[116,6,110,0,"_default"],[116,14,110,0],[116,17,110,15,"FakeEventTarget"],[116,32,110,30],[117,0,110,31],[117,3]],"functionMap":{"names":["<global>","stopped","invokeEventListeners","FakeEventTarget","addEventListener","removeEventListener","listeners.findIndex$argument_0","dispatchEvent"],"mappings":"AAA;gBCC;CDM;6BEG;CFuC;AGC;ECK;GDM;EEC;uCCC;KDI;GFE;EIG;GJmC;CHC"},"hasCjsExports":false},"type":"js/module"}]}